<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>Introducing Guirlande</title>
	<meta name="description" content="Sierra Wireless - AirVantage" />
	<meta name="robots" content="index, follow" />

    <link rel="alternate" type="application/rss+xml" title="RSS" href="/blog/feed.xml" />

    <link href="/resources/css/misc_icons.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="/resources/css/style.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="/resources/css/airvantage.github.io.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="/resources/css/pygments/default.css" rel="stylesheet" type="text/css" media="screen" />
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.2/jquery.min.js" type="text/javascript"></script>
    <script src="/resources/js/main.js" type="text/javascript"></script>
    <!-- flexslider -->
    <link type="text/css" rel="stylesheet" href="/resources/css/flexslider.css" />
    <script type="text/javascript" src="/resources/js/jquery.flexslider-min.js"></script>
    <!-- highlight syntax -->
    <link href="http://twitter.github.com/bootstrap/assets/js/google-code-prettify/prettify.css" rel="stylesheet">
    <script src="http://twitter.github.com/bootstrap/assets/js/google-code-prettify/prettify.js"></script>


    <!-- GA tracker -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-594061-16', 'airvantage.github.io');
      ga('send', 'pageview');

    </script>
    <!-- end GA tracker -->

</head>
<body>
     <div class="wrapper">
        <div id="top">
            <header>
                <h1><a title="back to top" href="/#introduction">Sierra Wireless - AirVantage</a></h1>
                <nav >
                    <a href="/#features"><i class="icon-github"></i> Repositories</a>
                    <a href="/devkit" >Dev. kit</a>
                    <a href="/#who">Who we are</a>
                    <a href="/blog"  class="link-selected" >Blog</a>
                    <a href="http://developer.sierrawireless.com" target="_blank"><span style="font-family: 'swop_icons' ; font-size:5em; line-height:0em; vertical-align:-0.2em;">L</span></a>
                </nav>
            </header>
        </div>
        
            <div id="content">
              

<div id="post">
	
    
        
        
            
            
        
        
    


<div id="page-navigation"> 
        <div class="clear">&nbsp;</div> 
        <span class="left"> 
         
        </span> 
        

        <span class="right"> 
         
        </span> 
        <div class="clear">&nbsp;</div> 
</div> 
	<h1 style="display:inline;">Introducing Guirlande</h1> by 
		<a href="/authors/kartben/page1">
			<span class="author">Benjamin Cabé</span>
		</a>	
	<h3 id="jenkinsci--rpi--led-strip--fireworks-">JenkinsCI + RPi + LED strip =&gt; Fireworks !</h3>

<p><img src="https://pbs.twimg.com/media/BIIkdD9CUAA9qly.jpg:thumb" alt="guirlande live" /></p>

<hr />

<ul id="markdown-toc">
  <li><a href="#jenkinsci--rpi--led-strip--fireworks-">JenkinsCI + RPi + LED strip =&gt; Fireworks !</a></li>
  <li><a href="#mihini-application-led-controller-instructions">Mihini application (led-controller) instructions</a></li>
  <li><a href="#nodejs-application-guirlandejs-instructions">Node.js application (guirlande.js) instructions</a>    <ul>
      <li><a href="#what-does-it-do-">What does it do ?</a></li>
      <li><a href="#instructions">Instructions</a></li>
    </ul>
  </li>
</ul>

<hr />

<p>Guirlande is the French for “fairy light”.
It’s a small M2M / IoT project that checks Jenkins CI builds and displays information related to their status on an LED strip driven by a Mihini Lua embedded application running on a Raspbery Pi.</p>

<h2 id="mihini-application-led-controller-instructions">Mihini application (led-controller) instructions</h2>

<p>You will need a Raspberry Pi (running e.g Raspbian) and an LPD8806 RGB LED strip (we are using http://www.adafruit.com/products/306)</p>

<ul>
  <li>The RGB LED strip will be accessed over SPI, so you will need to have SPI support.<br />
You should either use a distribution already providing SPI, or follow the instructions here http://www.brianhensley.net/2012/07/getting-spi-working-on-raspberry-pi.html, including the unblacklisting stuff.</li>
  <li>For all the instructions concerning the wiring of the strip to your Pi, you should follow http://learn.adafruit.com/light-painting-with-raspberry-pi/overview</li>
  <li>In order to run the Mihini application controlling the RGB LED strip, you need to install Mihini on your RaspberryPi: http://wiki.eclipse.org/Mihini/Run_Mihini_on_an_Open_Hardware_platform</li>
  <li>You will need to associate your deviceId of choice to your Pi, so as commands being sent by the bot polling Jenkins are correctly sent to <em>your</em> system.<br />
Once Mihini is running on the Pi, you can change the deviceId by doing:
    <ul>
      <li><code>telnet localhost 2000</code></li>
      <li><code>agent.config.agent.deviceId = "yourUniqueId"</code></li>
      <li><code>^D</code><br />
  You should then restart Mihini for the modification to be applied.  </li>
    </ul>
  </li>
  <li>Launch the application using Koneki IDE, in a very similar manner to what is explained in the wiki page mentioned earlier.<br />
Make sure to launch the Mihini app (main.lua) as <em>root</em>. This is done by using root credentials when configuring your remote connection in Eclipse Koneki IDE.<br />
Of course, you can also launch main.lua application by hand on the Raspberry Pi, but this is likely going to be more SCP roundtrips between your system and the Pi if you still want to benefit from the Koneki IDE magic :)</li>
</ul>

<h2 id="nodejs-application-guirlandejs-instructions">Node.js application (guirlande.js) instructions</h2>

<h4 id="what-does-it-do-">What does it do ?</h4>
<p>Basically it polls <em>x</em> Jenkins builds status, checks the “claim” state (see Claim report Jenkins plugin) and sends a command to the Mihini application to update the LED strip. 
The 64 LED strip will be split in <em>x</em> parts. Each part being split like this :</p>

<ul>
  <li>x * 3/4 for the build status</li>
  <li>x * 1/4 for the “claim” state</li>
</ul>

<h4 id="instructions">Instructions</h4>
<p>Just clone this repo, get the necessary dependencies :<br />
<code>npm install</code>  </p>

<p>Create a <em>config.json</em> based on the template to : </p>

<ul>
  <li>Change the Jenkins builds urls</li>
  <li>Use your own m3da server instead of the default one hosted on m2m.eclipse.org</li>
  <li>Set the DeviceId  you already used in the Mihini application</li>
  <li>Tweak the polling period</li>
</ul>

<p>And and launch it :<br />
 <code>node guirlande.js</code></p>

	<div id="related_posts">
		<h2>Related Posts</h2>
		<ul class="posts">

			
			
			  
			  
			    
			  
			                         
			
			  
			  
			    
			  
			                         
			
			  
			  
			    
			  
			                         
			
			  
			  
			    
			  
			                         
			
			  
			  
			    
			  
			                         
			
			  
			  
			    
			  
			                         
			
			  
			  
			    
			  
			                         
			
		</ul>
	</div>

</div>
              
              <div id="comments"> 
                <div id="disqus_thread"></div>
                <script type="text/javascript">
                /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                    var disqus_shortname = 'airvantageopensourcecenter'; // required: replace example with your forum shortname

                    /* * * DON'T EDIT BELOW THIS LINE * * */
                    (function() {
                        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                    })();
                    </script>
                    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
             </div>
             
            </div>
         
    </div>
</body>
</html>
